---
title: "Student Loans"
output: html_notebook
---

```{r}
library(lubridate)
library(tidyverse)

source("source.R")
```

# Loan Info Lists

```{r}
loan_info_list <- list(salliemae = list(name = "salliemae", bal = 14707.01, int = 0.04375, 
                                        min_pay = 207.97, fixed = F, months_left = NA),
                       navient1 = list(name = "navient1", bal = 2542.98, int = 0.0535, 
                                       min_pay = 38.04, fixed = T, months_left = 85),
                       navient2 = list(name = "navient2", bal = 3911.15, int = 0.0315, 
                                       min_pay = 54.32, fixed = T, months_left = 85),
                       navient3 = list(name = "navient3", bal = 1893.53, int = 0.0655, 
                                       min_pay = 31.09, fixed = T, months_left = 85),
                       navient4 = list(name = "navient4", bal = 4355.96, int = 0.0655, 
                                       min_pay = 95.80, fixed = T, months_left = 85))

loans_as_is <- conduct_schedule_analysis(loan_info_list, max_mo_pay = NA, int_tiebreak = "higher balance")
        
loans_pay600 <- conduct_schedule_analysis(loan_info_list, max_mo_pay = 600, int_tiebreak = "higher balance")

```

```{r}
loan_info_list2 <- list(salliemae = list(name = "sofi", bal = 23746.19, int = 0.04375, min_pay = 444.05, fixed = T),
                   navient2 = list(name = "navient2", bal = 3965.99, int = 0.0315, min_pay = 54.32, fixed = T))
  
loan_info_list3 <- list(salliemae = list(name = "sofi", bal = 27712.18, int = 0.04375, min_pay = 444.05, fixed = T))

```

```{r}
loan_info_refi <- list(list(name = "navient2", bal = 3911.15, int = 0.0315, min_pay = 54.32),
                       list(name = "commonbond", bal = 23499.48, int = 0.0454, min_pay = 442.92))

loans_pay_refi <- conduct_schedule_analysis(loan_info_refi, max_mo_pay = NA, int_tiebreak = "higher balance")

```


# Plots

Plot of balances and payments over time:

```{r}
plot_schedules(loans_as_is)
```

```{r}
plot_mo_payments(loans_pay800)
```



```{r}
payoff_options <- get_payoff_options(loan_info_list)

plot_payoff_options(payoff_options)
```

# Fix bug

```{r}
x <- list(salliemae = list(name = "Sallie Mae", bal = 14707.01, int = 0.04375,
                           min_pay = 207.97, fixed = F, months_left = NA),
          navient1 = list(name = "Navient 1", bal = 2575.84, int = 0.0535,
                          min_pay = 38.04, fixed = T, months_left = 85),
          navient2 = list(name = "Navient 2", bal = 3965.99, int = 0.0315,
                          min_pay = 54.32, fixed = T, months_left = 85))

payoff_opt <- get_payoff_options(x)
```


# Notes

Tasks:

Loans are on an ammoritizations schedule-- payments are the same each month but change in interest/principle ratio

They can specify a time to pay off and have no upper bound on monthly payments. Or they can have upper bound on monthly payments and either pay it off in their desired time frame or before (if possible) or receive a message saying "with your upper monthly bound of $XX, you are going to have to keep paying Y months beyond your desired end date"

Need to account for:
* The month a loan is paid off, there is "leftover" extra payment. Designate this towards the next loan.
* If a loan gets paid off while paying off extra for a higher interest loan. (Not common if loans have same payment schedule-- not true if you have been paying off one loan early)

* what if they input only months, and no max payment?
* what if they input months and max_payment but actual monthly payments would be less than max_payment?

Seems like if they input months, we have to calculate it that way and with max_payment and do post hoc comparisons

But how to do schedules with only months and no max payment? How to determine total monthly $ required to pay off those loans. Maybe this is a feature to add later. 

Why does paying off the higher balance result in less overall interest when interest rates are the same?

Optional original principle to back calculate how much they have been paying (if this doesn't make sense going back in time - not round - just made the line dashed with no definitive start point. People could have been overpaying, reducing their balance.

If lower rate loan is paid off before end of load, "leftover" payment must move on to next loan. Make sure to account for when smaller rate loans are paid off before higher rate loans - they must be removed from sort_df.

What about including other aspects of folks with student loans, e.g. income and rent


Notes:

Navient warned me if I asked to increase my overpayments I'd be locked in as if I can't just 
call them back if I can't swing it.

SoFi said I will save $3,705.60 over the life of my loan... This is questionable. Verify my results against other calculators/spreadsheets. 

I've accidentally overpaid my navient4 loan so it hasn't been pulling from my account for months and I've advanced my due date to January 2019, but all the while they have been getting interest from me. It's like I haven't been paying them off early...  Still have 85 months left. Actually this is untrue because I've signed up for autopay.

Features:

Download schedules
Email reminders for when they should call to increase loan amounts

Taxes information

There is something funny here, for Navient 1:
unpaid principal 2575.84
unpaid interest 4.91
 
85 months * 38.04

After talking to a guy at Navient, I realized this schedule is not updated if there are any overpayments, etc. The X months @ $Y really can't be trusted. 

Text needed:
* No variable interest rates accounted for
* 
