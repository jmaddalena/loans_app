---
title: "Redo Plan"
output: html_document
---

My first iteration overcomplicated things a bit by requiring loan payments to be calculated over several months at a time, the number of months of which was based on the remaining loan of highest interest. This made it impossible to properly direct overpayments when a smaller term loan is paid off making only minimum payments while overpaying another loan. 

This situation created the necessity for a calculator that calculates all loans month-by-month. On top of calculating interest and principle each month, the calculator needs to keep track of:
* the highest interest loan remaining
* the remaining balance of each loan
* if any loan balances have reached zero
* overpay = max_mo_pay - sum(minimum mo payments)

I believe each month, minimum payments should be calculated first. Then overpayment can be added to the payment of the highest interest loan. Payments and balances should be recorded. 

Special handling is required for the following circumstances:
1. Overpaid loan has reached balance 0. Leftover overpayment needs to be added to next highest interest loan.
2. One of minimum payment loans gets paid off. Add leftover to overpayment. 

As I write this out, I realized how truly overcomplicated iteration #1 was. This version should be much more straightforward, as long as care is taken with handling balances and payments. 

```{r}
library(lubridate)
library(tidyverse)

source("funcs_iter.R")

x <- list(list(name = "Sample loan 1", balance = 2000, int = 0.065, min_pay = 22.71),
          list(name = "Sample loan 2", balance = 6000, int = 0.065, min_pay = 80.32),
          list(name = "Sample loan 3", balance = 8000, int = 0.05, min_pay = 84.86),
          list(name = "Sample loan 4", balance = 1000, int = 0.03, min_pay = 17.97),
          list(name = "Sample loan 5", balance = 4000, int = 0.025, min_pay = 37.71))
          
```

```{r}
sched <- conduct_schedule_analysis(loan_info_list = x, max_mo_pay = NA)

levels(sched)

plot_mo_payments(sched)

```

```{r}
sched2 <- conduct_schedule_analysis(loan_info_list = x, max_mo_pay = 500)

```


